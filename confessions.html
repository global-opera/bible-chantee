<script>
    const promesses = [
      {
        num: 1, file: "01_Presence", title: "Je suis dans Ta présence", verse: "Psaume 16:11",
        lyrics: [
          {t:0.0,text:""},
          {t:9.5,text:"Dans Ta présence il y a la plénitude de joie"},
          {t:16.2,text:"À Ta droite des délices éternels"},
          {t:22.9,text:"Je suis dans Ta présence, Seigneur"},
          {t:29.6,text:"Mon cœur se réjouit en Toi"},
          {t:36.3,text:"Dans Ta présence, je suis comblé"},
          {t:43.0,text:"Dans Ta présence, je suis heureux"},
          {t:49.7,text:"Dans Ta présence, il y a la vie"},
          {t:56.4,text:"Dans Ta présence, je suis restauré"}
        ]
      },
      {
        num: 2, file: "02_Protection", title: "Je suis protégé", verse: "Psaume 91",
        lyrics: [
          {t:0.0,text:""},
          {t:8.8,text:"Celui qui demeure sous l’abri du Très-Haut"},
          {t:15.5,text:"Repose à l’ombre du Tout-Puissant"},
          {t:22.2,text:"Je dis à l’Éternel : Mon refuge et ma forteresse"},
          {t:28.9,text:"Mon Dieu en qui je me confie"},
          {t:35.6,text:"Il te couvrira de Ses plumes"},
          {t:42.3,text:"Et sous Ses ailes tu trouveras un refuge"},
          {t:49.0,text:"Je suis protégé, je suis protégé"},
          {t:55.7,text:"Par le Dieu vivant"}
        ]
      },
      {
        num: 3, file: "03_Force", title: "Je suis fort en Toi", verse: "Ésaïe 40:31",
        lyrics: [
          {t:0.0,text:""},
          {t:9.2,text:"Ceux qui se confient en l’Éternel"},
          {t:15.9,text:"Renouvellent leur force"},
          {t:22.6,text:"Ils prennent leur envol comme les aigles"},
          {t:29.3,text:"Ils courent et ne se lassent point"},
          {t:36.0,text:"Ils marchent et ne se fatiguent point"},
          {t:42.7,text:"Je suis fort, je suis fort en Toi Seigneur"},
          {t:49.4,text:"Ma force est renouvelée chaque matin"}
        ]
      },
      {
        num: 4, file: "04_Sagesse", title: "Je reçois la sagesse", verse: "Jacques 1:5",
        lyrics: [
          {t:0.0,text:""},
          {t:8.7,text:"Si quelqu’un d’entre vous manque de sagesse"},
          {t:15.4,text:"Qu’il la demande à Dieu"},
          {t:22.1,text:"Qui donne à tous simplement et sans reproche"},
          {t:28.8,text:"Et elle lui sera donnée"},
          {t:35.5,text:"Je reçois la sagesse, je reçois la sagesse"},
          {t:42.2,text:"Du Dieu qui donne généreusement"}
        ]
      },
      {
        num: 5, file: "05_Victoire", title: "Je suis plus que vainqueur", verse: "Romains 8:37",
        lyrics: [
          {t:0.0,text:""},
          {t:9.0,text:"En toutes ces choses nous sommes"},
          {t:15.7,text:"Plus que vainqueurs par Celui qui nous a aimés"},
          {t:22.4,text:"Je suis plus que vainqueur"},
          {t:29.1,text:"Par le sang de Jésus"},
          {t:35.8,text:"Aucune puissance ne peut me séparer"},
          {t:42.5,text:"De l’amour de Dieu"}
        ]
      },
      {
        num: 6, file: "06_Amour", title: "Je suis aimé de Dieu", verse: "Romains 8:38-39",
        lyrics: [
          {t:0.0,text:""},
          {t:9.3,text:"Je suis convaincu que ni la mort ni la vie"},
          {t:16.0,text:"Ni les anges ni les dominations"},
          {t:22.7,text:"Ni le présent ni l’avenir"},
          {t:29.4,text:"Ne pourront me séparer de l’amour de Dieu"},
          {t:36.1,text:"Je suis aimé, je suis aimé"},
          {t:42.8,text:"D’un amour éternel"}
        ]
      },
      {
        num: 7, file: "07_Provisions", title: "Tous mes besoins sont comblés", verse: "Philippiens 4:19",
        lyrics: [
          {t:0.0,text:""},
          {t:8.9,text:"Mon Dieu pourvoira à tous vos besoins"},
          {t:15.6,text:"Selon Ses richesses avec gloire"},
          {t:22.3,text:"En Jésus-Christ"},
          {t:29.0,text:"Tous mes besoins sont comblés"},
          {t:35.7,text:"En Jésus-Christ"},
          {t:42.4,text:"Je ne manque de rien"}
        ]
      },
      {
        num: 8, file: "08_Paix", title: "J’ai la paix de Dieu", verse: "Philippiens 4:7",
        lyrics: [
          {t:0.0,text:""},
          {t:9.1,text:"La paix de Dieu qui surpasse toute intelligence"},
          {t:15.8,text:"Garde vos cœurs et vos pensées"},
          {t:22.5,text:"En Jésus-Christ"},
          {t:29.2,text:"J’ai la paix de Dieu"},
          {t:35.9,text:"Elle garde mon cœur et mon esprit"}
        ]
      },
      {
        num: 9, file: "09_Lumiere", title: "Je suis lumière du monde", verse: "Matthieu 5:14",
        lyrics: [
          {t:0.0,text:""},
          {t:8.6,text:"Vous êtes la lumière du monde"},
          {t:15.3,text:"Une ville située sur une montagne ne peut être cachée"},
          {t:22.0,text:"Je suis lumière du monde"},
          {t:28.7,text:"Je brille pour Jésus"},
          {t:35.4,text:"Que ma lumière luise devant les hommes"}
        ]
      },
      {
        num: 10, file: "10_Esprit", title: "Je suis rempli du Saint-Esprit", verse: "Actes 1:8",
        lyrics: [
          {t:0.0,text:""},
          {t:9.4,text:"Vous recevrez une puissance"},
          {t:16.1,text:"Le Saint-Esprit survenant sur vous"},
          {t:22.8,text:"Et vous serez mes témoins"},
          {t:29.5,text:"Je suis rempli du Saint-Esprit"},
          {t:36.2,text:"Il me donne la puissance"}
        ]
      },
      {
        num: 11, file: "11_Guerison", title: "Je suis guéri", verse: "Ésaïe 53:5",
        lyrics: [
          {t:0.0,text:""},
          {t:9.0,text:"Par Ses meurtrissures nous sommes guéris"},
          {t:15.7,text:"Il a été blessé pour nos péchés"},
          {t:22.4,text:"Par Ses blessures je suis guéri"},
          {t:29.1,text:"La guérison est mon partage aujourd’hui"}
        ]
      },
      {
        num: 12, file: "12_Eternite", title: "J’ai la vie éternelle", verse: "Jean 3:16",
        lyrics: [
          {t:0.0,text:""},
          {t:9.6,text:"Car Dieu a tant aimé le monde"},
          {t:16.3,text:"Qu’Il a donné Son Fils unique"},
          {t:23.0,text:"Afin que quiconque croit en Lui"},
          {t:29.7,text:"Ne périsse point mais ait la vie éternelle"},
          {t:36.4,text:"J’ai la vie éternelle"},
          {t:43.1,text:"Je ne péris point"},
          {t:49.8,text:"Je vis pour toujours avec Jésus"}
        ]
      }
    ];

    // Génération des cartes
    const grid = document.getElementById('grid');
    promesses.forEach(p => {
        grid.innerHTML += `
            <div class="card" onclick="openPopup(${p.num})">
                <div class="icon">✨</div>
                <div class="num">Promesse ${p.num}</div>
                <div class="title">${p.title}</div>
                <div class="verse">${p.verse}</div>
            </div>`;
    });

    let currentLine = -1;

    function openPopup(n) {
        const p = promesses[n-1];
        document.getElementById('popupTitle').textContent = p.title;
        document.getElementById('popupVerse').textContent = p.verse;

        const audio = document.getElementById('audio');
        audio.src = `promesses/${p.file}.mp3`;

        const scroll = document.getElementById('lyricsScroll');
        scroll.innerHTML = p.lyrics.map((l,i) => `<div class="lyric-line" id="line${i}">${l.text}</div>`).join('');

        document.getElementById('popup').style.display = 'block';
        audio.play();
        currentLine = -1;
    }

    document.getElementById('audio').addEventListener('timeupdate', () => {
        const t = document.getElementById('audio').currentTime;
        let newLine = -1;
        for (let i = promesses.find(p => p.num === currentNum)?.lyrics.length-1 || 0; i >= 0; i--) {
            if (t >= promesses.find(p => p.num === currentNum)?.lyrics[i].t) {
                newLine = i;
                break;
            }
        }
        if (newLine !== currentLine) {
            currentLine = newLine;
            document.querySelectorAll('.lyric-line').forEach((el, i) => {
                el.classList.toggle('active', i === currentLine);
            });
            if (currentLine >= 0) {
                scroll.style.transform = `translateY(${100 - (currentLine * 60)}px)`;
            }
        }
    });

    function closePopup() {
        document.getElementById('popup').style.display = 'none';
        document.getElementById('audio').pause();
    }

    let currentNum = 0;
    function openPopup(n) {
        currentNum = n;
        // … le reste du code reste identique
    }
</script>